---
number: 41
title: Модели аппаратного перемещения программ.
---

**Модели аппаратного перемещения программ**  - это специальные архитектурные решения в компьютерах, которые позволяют процессу перемещаться в памяти без необходимости переписывать саму программу.

### Классическая модель
Классический случай представлен на левой части слайда. Он включает аппаратную поддержку для каждой программы двумя регистрами:

- базовый регистр - указывает на начало программы
- регистр границы - конец программы (иногда вместо него указывается длина сегмента)

В пользовательской программе относительный адрес закодирован в виде смещений. Он складывается с базовым регистром, в результате получается абсолютный адрес (зеленая стрелочка)

Регистр границы обычно используется для проверки выхода абсолютного адреса за границы программы. Выше базового регистра обратиться нельзя, ниже регистра границы тоже. При этом данные, необходимые для работы ОС, тоже вне области пользовательской программы. Например PCB. При выходе за границы вызывается прерывание.

### Сегментная модель
В x86-8086 применялась сегментная адресация: логический адрес = сегментный регистр + смещение, где сегментный регистр задает начало сегмента. Сегментный регистр (16 бит) сдвигается влево на 4 бита, затем к нему прибавляется 16ти битное смещение, так получается 20ти битный физический адрес и адресуемые ~64Кб памяти

Есть несколько сегментных регистров (CS, DS, SS, ES), которые задают разные логические сегменты: код, данные, стек и прочее. Команды указывают, с каким сегментом работать.

В простой COM-модели все сегментные регистры указывали на один и тот же базовый адрес (до 64Кб кода+данных), что давало быстрый старт. А более сложные EXE-программы размещали сегменты в разные места, позволяя занимать больше памяти

![](images/41_mem_models.png)