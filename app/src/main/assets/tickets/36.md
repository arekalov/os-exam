---
number: 36
title: Примитивы синхронизации ОС. Условные переменные, rwlocks.
---

**Примитивы синхронизации** — это базовые механизмы, предоставляемые ОС и языками программирования для правильной организации совместного доступа к ресурсам и координации работы между процессами/потоками при параллельном выполнении.


## Предназначение примитивов синхронизации
Повзоляют избавиться от проблем параллельного выполнения:
### 1. Взаимоисключения (Mutual Exclusion)
- Ситуация, когда несколько параллельных процессов или потоков пытаются одновременно получить доступ к общему (разделяемому) ресурсу.
- Требуется механизм взаимного исключения, чтобы только один процесс/поток мог работать с этим ресурсом в данный момент времени (например, запись в файл, изменение переменной).

### 2. Взаимоблокировки (Deadlocks)
- Состояние, когда два или более процесса (потока) навечно ждут освобождения ресурсов, которые уже захвачены друг другом.
- Например: Процесс А захватил ресурс X и ждёт ресурс Y, удерживаемый процессом B, который в свою очередь ждёт освобождения ресурса X.
- Взаимоблокировка часто приводит к "заморозке" части системы.

### 3. Голодание (Starvation)
- Ситуация, когда процесс или поток длительно не может получить доступ к необходимому ресурсу из-за постоянной конкуренции с другими задачами.
- Возникает, если планировщик ресурсов отдаёт приоритет другим процессам или потокам, и "голодающий" процесс не получает своей очереди.

---

## Условные переменные (Condition Variables)

**Условная переменная** — это примитив синхронизации, позволяющий потоку приостановить выполнение (и отпустить мьютекс) до тех пор, пока не произойдёт определённое событие или не будет выполнено условие.

- Используется только вместе с мьютексом (mutex).
- Поток может "спать" (wait), пока условие не станет истинным.
- Другой поток после изменения состояния вызывает сигнал (`signal` или `notify`), чтобы разбудить ожидающие потоки.
- Очень удобно для паттернов "производитель-потребитель", когда нужно дождаться заполнения/освобождения буфера.

Блокировки чтения/записи (Read-Write Lock, rwlock)
RWLock — это примитив синхронизации, позволяющий повысить производительность при большом числе операций чтения по сравнению с операциями записи:

Несколько потоков могут одновременно читать данные (read lock) — если никто не пишет.
Только один поток может писать (write lock), и в этот момент все другие (и читатели, и писатели) блокируются.
Позволяет увеличить параллелизм при большом количестве потоков-читателей.

![](images/36_vars.png)
---

## Блокировки чтения/записи (Read-Write Lock, rwlock)
RWLock — это примитив синхронизации, позволяющий повысить производительность при большом числе операций чтения по сравнению с операциями записи:

- Несколько потоков могут одновременно читать данные (read lock) — если никто не пишет.
- Только один поток может писать (write lock), и в этот момент все другие (и читатели, и писатели) блокируются.
- Позволяет увеличить параллелизм при большом количестве потоков-читателей.

![](images/36_vars.png)