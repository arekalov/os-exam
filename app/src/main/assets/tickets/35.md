---
number: 35
title: Примитивы синхронизации ОС. Семафоры и мьютексы. Бинарный семафор
---

**Примитивы синхронизации** — это базовые механизмы, предоставляемые ОС и языками программирования для правильной организации совместного доступа к ресурсам и координации работы между процессами/потоками при параллельном выполнении.


## Предназначение примитивов синхронизации
Повзоляют избавиться от проблем параллельного выполнения:
### 1. Взаимоисключения (Mutual Exclusion)
- Ситуация, когда несколько параллельных процессов или потоков пытаются одновременно получить доступ к общему (разделяемому) ресурсу.
- Требуется механизм взаимного исключения, чтобы только один процесс/поток мог работать с этим ресурсом в данный момент времени (например, запись в файл, изменение переменной).

### 2. Взаимоблокировки (Deadlocks)
- Состояние, когда два или более процесса (потока) навечно ждут освобождения ресурсов, которые уже захвачены друг другом.
- Например: Процесс А захватил ресурс X и ждёт ресурс Y, удерживаемый процессом B, который в свою очередь ждёт освобождения ресурса X.
- Взаимоблокировка часто приводит к "заморозке" части системы.

### 3. Голодание (Starvation)
- Ситуация, когда процесс или поток длительно не может получить доступ к необходимому ресурсу из-за постоянной конкуренции с другими задачами.
- Возникает, если планировщик ресурсов отдаёт приоритет другим процессам или потокам, и "голодающий" процесс не получает своей очереди.

---

## Семафор (Semaphore)

**Семафор** — это примитив синхронизации, предназначенный для управления доступом к одному или нескольким общим ресурсам.

- Представляет собой целое значение (счётчик), над которым определены две атомарные операции:
  - **P (wait, down, acquire):** если семафор > 0, уменьшить на 1; если 0 — ждать освобождения.
  - **V (signal, up, release):** увеличить значение на 1 и, если кто-то ждёт — разбудить его.
- Может быть использован для ограничения количества потоков, одновременно использующих ресурс (например, пул соединений).

### Виды семафоров:
- **Счётный (counting)**: значение может быть больше 1, разрешая доступ N участникам одновременно.
- **Бинарный (binary)**: значение только 0 или 1 (по сути — мьютекс).

![](images/35_semaphore.png)

---

## Мьютекс (Mutex)

**Мьютекс (mutual exclusion)** — это примитив синхронизации, гарантирующий, что только один поток или процесс может иметь доступ к критическому ресурсу в каждый момент времени.

- Мьютекс может быть либо "захвачен" (locked), либо "освобождён" (unlocked).
- Если поток пытается захватить уже занятый мьютекс, он будет заблокирован до тех пор, пока мьютекс не освободит владелец.
- Обычно у мьютекса есть понятие "владельца" — освободить мьютекс может только тот поток, который его захватил.

![](images/35_mutex.png)